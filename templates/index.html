<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Price Prediction App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        .containers {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 500px;
        }

        h2 {
            text-align: center;
            margin-bottom: 20px;
        }

        input {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            border-radius: 4px;
        }

        button:hover {
            background-color: #45a049;
        }

        .result {
            font-size: 18px;
            text-align: center;
            margin-top: 20px;
        }

        ul.suggestions {
            list-style-type: none;
            padding: 0;
            margin: 0;
            position: absolute;
            background-color: white;
            border: 1px solid #ddd;
            width: 100%;
        }

        ul.suggestions li {
            padding: 10px;
            cursor: pointer;
        }

        ul.suggestions li:hover {
            background-color: #eee;
        }
    </style>
</head>
<body>

<div class="containers">
    <h2>Commodity Price Prediction</h2>

    <form id="predictionForm" action="/submit" method="POST">
        <label for="state-input">State:</label>
        <input type="text" id="state-input" name="state_code" placeholder="Enter state" onkeyup="showSuggestions(this, 'state')" autocomplete="off">
        <ul id="state-suggestions" class="suggestions"></ul>

        <label for="district-input">District:</label>
        <input type="text" id="district-input" name="district" placeholder="Enter district" onkeyup="showSuggestions(this, 'district')" autocomplete="off">
        <ul id="district-suggestions" class="suggestions"></ul>

        <label for="market-input">Market:</label>
        <input type="text" id="market-input" name="market" placeholder="Enter market" onkeyup="showSuggestions(this, 'market')" autocomplete="off">
        <ul id="market-suggestions" class="suggestions"></ul>

        <label for="commodity-input">Commodity:</label>
        <input type="text" id="commodity-input" name="commodity" placeholder="Enter commodity" onkeyup="showSuggestions(this, 'commodity')" autocomplete="off">
        <ul id="commodity-suggestions" class="suggestions"></ul>

        <label for="variety-input">Variety:</label>
        <input type="text" id="variety-input" name="variety" placeholder="Enter variety" onkeyup="showSuggestions(this, 'variety')" autocomplete="off">
        <ul id="variety-suggestions" class="suggestions"></ul>

        <label for="min-price-input">Minimum Price:</label>
        <input type="number" id="min-price-input" name="min_price" placeholder="Enter minimum price">

        <label for="max-price-input">Maximum Price:</label>
        <input type="number" id="max-price-input" name="max_price" placeholder="Enter maximum price">

        <button type="submit">Submit</button>
    </form>

    <div class="result" id="predictionResult"></div>

</div>

<script>
    const data = {
        state: {'Andaman and Nicobar': 0, 'Andhra Pradesh': 1, 'Assam': 2, 'Chattisgarh': 3, 'Goa': 4, 'Gujarat': 5, 'Haryana': 6, 'Himachal Pradesh': 7, 'Jammu and Kashmir': 8, 'Karnataka': 9, 'Kerala': 10, 'Madhya Pradesh': 11, 'Maharashtra': 12, 'Manipur': 13, 'Meghalaya': 14, 'Nagaland': 15, 'Odisha': 16, 'Pondicherry': 17, 'Punjab': 18, 'Rajasthan': 19, 'Tamil Nadu': 20, 'Telangana': 21, 'Tripura': 22, 'Uttar Pradesh': 23, 'Uttrakhand': 24, 'West Bengal': 25},
        district: {'Agra': 0, 'Ahmednagar': 1, 'Alappuzha': 2, 'Aligarh': 3, 'Allahabad': 4, 'Ambala': 5, 'Amreli': 6, 'Amritsar': 7, 'Anand': 8, 'Angul': 9},
        market: {'Acharapakkam': 0, 'Achnera': 1, 'Adampur': 2, 'Ait': 3, 'Akluj': 4, 'Aliganj': 5, 'Ammoor': 6, 'Anaimalai': 7, 'Anchal': 8},
        commodity: {'Amaranthus': 0, 'Amla(Nelli Kai)': 1, 'Amphophalus': 2, 'Apple': 3, 'Arecanut(Betelnut/Supari)': 4},
        variety: {' Subabul': 0, '(Red Nanital)': 1, '1001': 2, '1009 Kar': 3, '1121': 4, '147 Average': 5}
    };

    function showSuggestions(input, type) {
        const suggestionsBox = document.getElementById(type + '-suggestions');
        const value = input.value.toLowerCase();
        suggestionsBox.innerHTML = '';

        const filtered = Object.keys(data[type]).filter(item => item.toLowerCase().startsWith(value));

        if (filtered.length > 0) {
            filtered.forEach(item => {
                const li = document.createElement('li');
                li.innerText = item;
                li.onclick = function() {
                    input.value = item;
                    suggestionsBox.innerHTML = '';
                };
                suggestionsBox.appendChild(li);
            });
        }
    }

    document.getElementById("predictionForm").onsubmit = function(event) {
        event.preventDefault();

        const state = document.getElementById("state-input").value;
        const district = document.getElementById("district-input").value;
        const market = document.getElementById("market-input").value;
        const commodity = document.getElementById("commodity-input").value;
        const variety = document.getElementById("variety-input").value;
        const minPrice = document.getElementById("min-price-input").value;
        const maxPrice = document.getElementById("max-price-input").value;

        const formData = {
            state: data.state[state] || 0,
            district: data.district[district] || 0,
            market: data.market[market] || 0,
            commodity: data.commodity[commodity] || 0,
            variety: data.variety[variety] || 0,
            min_price: parseFloat(minPrice),
            max_price: parseFloat(maxPrice)
        };

        fetch('/predict', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById("predictionResult").innerHTML = `<strong>Predicted Price: ${data.prediction}</strong>`;
        })
        .catch(error => {
            document.getElementById("predictionResult").innerHTML = `Error: ${error}`;
            console.error('Error:', error);
        });
    };
</script>

</body>
</html>
